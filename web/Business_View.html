<!DOCTYPE html>
<html>
<head>
    <title>Business View Page</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <link rel="stylesheet" type="text/css" href="./css/Business_View.css">

    <script type="text/javascript">

        $.ajaxSetup({   
            async : false  
        }); 
        var per=[
            {id:'1', hairdresser:'Beth', service_type:'Haircut', perhour_charge:'$70'}
        ];

        var per2 = [
            {id:'1', hairdresser:'Beth', service_type:'Hair Wash & Dry', perhour_charge:'$60'}
        ];

        var per3 = [
            {id:'1', hairdresser:'Beth', service_type:'Hair Colour', perhour_charge:'$60'}
        ];
        $.post("../backend/query_service.php",
            {
                sellist2:'Haircut'
            },
            function(data){
                per[0].perhour_charge = "$"+data;
            });
        $.post("../backend/query_service.php",
            {
                sellist2:'Hair Wash & Dry'
            },
            function(data){
                per2[0].perhour_charge = "$"+data;
            });
        $.post("../backend/query_service.php",
            {
                sellist2:'Hair Colour'
            },
            function(data){
                per3[0].perhour_charge = "$"+data;
            });

        function getDataRow(h) {
            var row=document.createElement('tr');

            var idCell=document.createElement('td');

            idCell.innerText = h.id;

            row.appendChild(idCell);

            var hairdresserCell=document.createElement('td');
            hairdresserCell.innerText = h.hairdresser;
            row.appendChild(hairdresserCell);

            var chargeCell=document.createElement('td');
            chargeCell.innerText = h.perhour_charge;
            row.appendChild(chargeCell);

            return row;
        }

        $(document).ready(function() {
            tbody = document.getElementById('t1');
            for(var i=0;i<per.length;i++){
                var trow=getDataRow(per[i]);
                tbody.appendChild(trow);
            }
            tbody = document.getElementById('t2');
            for(var i=0;i<per2.length;i++){
                var trow=getDataRow(per2[i]);
                tbody.appendChild(trow);
            }
            tbody = document.getElementById('t3');
            for(var i=0;i<per3.length;i++){
                var trow=getDataRow(per3[i]);
                tbody.appendChild(trow);
            }
            
            var today = new Date();
            var dd = String(today.getDate()).padStart(2, '0');
            var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
            var yyyy = today.getFullYear();
            var days = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
            var months = ['January','February','March','April','May','June','July','August','September','October','November','December'];

            var day = days[ today.getDay() ];

            today_text = 'Today is ' + day + ', ' +mm + '/' + dd + '/' + yyyy;
            today_date = day + ', ' +mm + '/' + dd 
            document.getElementById('date1').innerHTML = today_text; 
            document.getElementById('date2').innerHTML = today_text;
            document.getElementById('date3').innerHTML = today_text;    
            document.getElementById('date_option').innerHTML = today_date;

            var two_day = days[ (today.getDay() + 1) % 7 ];
            var two = new Date(today.getTime() + (24 * 60 * 60 * 1000));
            var two_dd = String(two.getDate()).padStart(2, '0');
            var two_mm = String(two.getMonth() + 1).padStart(2, '0');
            two_day_date = two_day + ', ' + two_mm + '/' + two_dd 
            document.getElementById('date_option_2').innerHTML = two_day_date; 

            var three_day = days[ (today.getDay() + 2) % 7 ];
            var three = new Date(two.getTime() + (24 * 60 * 60 * 1000));
            var three_dd = String(three.getDate()).padStart(2, '0');
            var three_mm = String(three.getMonth() + 1).padStart(2, '0');
            three_day_date = three_day + ', ' + three_mm + '/' + three_dd 
            document.getElementById('date_option_3').innerHTML = three_day_date; 

            var four_day = days[ (today.getDay() + 3) % 7 ];
            var four = new Date(three.getTime() + (24 * 60 * 60 * 1000));
            var four_dd = String(four.getDate()).padStart(2, '0');
            var four_mm = String(four.getMonth() + 1).padStart(2, '0');
            four_day_date = four_day + ', ' + four_mm + '/' + four_dd 
            document.getElementById('date_option_4').innerHTML = four_day_date; 

            var five_day = days[ (today.getDay() + 4) % 7 ];
            var five = new Date(four.getTime() + (24 * 60 * 60 * 1000));
            var five_dd = String(five.getDate()).padStart(2, '0');
            var five_mm = String(five.getMonth() + 1).padStart(2, '0');
            five_day_date = five_day + ', ' + five_mm + '/' + five_dd 
            document.getElementById('date_option_5').innerHTML = five_day_date; 

            var six_day = days[ (today.getDay() + 5) % 7 ];
            var six = new Date(five.getTime() + (24 * 60 * 60 * 1000));
            var six_dd = String(six.getDate()).padStart(2, '0');
            var six_mm = String(six.getMonth() + 1).padStart(2, '0');
            six_day_date = six_day + ', ' + six_mm + '/' + six_dd 
            document.getElementById('date_option_6').innerHTML = six_day_date; 

            var seven_day = days[ (today.getDay() + 6) % 7 ];
            var seven = new Date(six.getTime() + (24 * 60 * 60 * 1000));
            var seven_dd = String(seven.getDate()).padStart(2, '0');
            var seven_mm = String(seven.getMonth() + 1).padStart(2, '0');
            seven_day_date = seven_day + ', ' + seven_mm + '/' + seven_dd 
            document.getElementById('date_option_7').innerHTML = seven_day_date; 


            var eight_day = days[ (today.getDay() + 7) % 7 ];
            var eight = new Date(seven.getTime() + (24 * 60 * 60 * 1000));
            var eight_dd = String(eight.getDate()).padStart(2, '0');
            var eight_mm = String(eight.getMonth() + 1).padStart(2, '0');
            eight_day_date = eight_day + ', ' + eight_mm + '/' + eight_dd 
            document.getElementById('date_option_8').innerHTML = eight_day_date; 

        })

       
     </script>

</head>
<body onload="func_query()">
    <span id="user" style="display:none"></span>
    <span id="admin" style="display:none">false</span>

    <nav class="navbar navbar-expand-sm bg-dark navbar-dark">
        
        <a class="navbar-brand" href="#">
            <img src="images/web_brand_icon.png" alt="Logo" style="width:50px;">
        </a>
      
        <ul class="navbar-nav ml-auto">
            <li class="nav-item">
                <a class="nav-link active" href="Business_View.html">Services</a>
            </li>

            <li class="nav-item">
                <a class="nav-link" href="Login.html">Login</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="Register.html">Registration</a>
            </li>

        </ul>


    </nav>

    <div class="container">
        <div class="d-flex justify-content-center h-100">
            <div class="card">
                
                <div class="card-header">
                    <div id="myheader">
                        Beauty Care Services Catologue
                    </div>
                    <ul id='myTab' class="nav nav-tabs nav-justified">
                        <li class="nav-item">
                          <a class="nav-link active" href="#haircut" data-toggle="tab">Haircut</a>
                        </li>
                        <li class="nav-item">
                          <a class="nav-link" href="#hair_wash_dry" data-toggle="tab">Hair Wash & Dry</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#hair_colour" data-toggle="tab"s>Hair Colour</a>
                          </li>
                     </ul>
                </div>

                <div class="card-body">

                    <div id="myTabContent" class="tab-content">

                        <div class="tab-pane active" id="haircut">
                            <br>
                            <img src="images/haircut.jpg" class="rounded mx-auto d-block" alt="haircut">
                            <br>
                            <h4>Haircut Service Table:</h4>
                            <p>View the available service items and add your new service:</p>
                            <p id='date1'></p>
                            <table class="table" id="t1">
                                <thead>
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">Hairdresser</th>
                                    <th scope="col">Charge (AUD)</th>
                                </tr>
                                </thead>
                            </table>
                        </div>

                        <div class="tab-pane" id="hair_wash_dry">
                            <br>
                            <img src="images/hairwash.jpg" class="rounded mx-auto d-block" alt="hairwash">
                            <br>
                            <h4>Hair Wash & Dry Service Table:</h4>
                            <p>View the available service items and add your new service:</p>
                            <p id='date2'></p>
                            <table class="table" id="t2">
                                <thead>
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">Hairdresser</th>
                                    <th scope="col">Charge (AUD)</th>
                                </tr>
                                </thead>
                            </table>
                        </div>


                        <div class="tab-pane" id="hair_colour">
                            <br>
                            <img src="images/hair_colour.jpg" class="rounded mx-auto d-block" alt="hair_colour">
                            <br>
                            <h4>Hair Colour Service Table:</h4>
                            <p>View the available service items and add your new service:</p>
                            <p id='date3'></p>
                            <table class="table" id="t3">
                                <thead>
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">Hairdresser</th>
                                    <th scope="col">Charge (AUD)</th>
                                </tr>
                                </thead>
                            </table>
                        </div>

                        </br>

                        <div class="update_service">
                            <h4>Service Creation Interface:</h4>
                            <form id="server_service" action="../backend/query_service.php" method="POST" target="nm_iframe">
                                <div class="form-group">
                                    <label for="sel1">Select responding hairdresser:</label>
                                    <select class="form-control" id="sel1" name="sellist1">
                                      <option>Beth</option>
                                    </select>
                                    <br>
                                    <label for="sel2">Select service type:</label>
                                    <select class="form-control" id="sel2" name="sellist2" onchange="func_query()">
                                      <option>Haircut</option>
                                      <option>Hair Wash & Dry</option>
                                      <option>Hair Colour</option>
                                    </select>
                                    <br>
                                    <!--
                                    <label for="sel3">Select service date:</label>
                                    <select class="form-control" id="sel3" name="sellist3">
                                        <option id='date_option'></option>
                                        <option id='date_option_2'></option>
                                        <option id='date_option_3'></option>
                                        <option id='date_option_4'></option>
                                        <option id='date_option_5'></option>
                                        <option id='date_option_6'></option>
                                        <option id='date_option_7'></option>
                                        <option id='date_option_8'></option>
                                      </select>
                                     <br>
                                    <label for="sel4">Select service time:</label>
                                    <select class="form-control" id="sel4" name="sellist4">
                                        <option>9:00 - 10:00 AM</option>
                                        <option>10:00 - 11:00 AM</option>
                                        <option>11:00 - 12:00 AM</option>
                                        <option>1:00 - 2:00 PM</option>
                                        <option>2:00 - 3:00 PM</option>
                                        <option>3:00 - 4:00 PM</option>
                                        <option>4:00 - 5:00 PM</option>
                                      </select>
                                     <br>
                                     --> 
                                    <label for="charge">Decide charge (AUD):</label>
                                    <input type="number" min="0" step="1" oninput="validity.valid||(value='');" class="form-control" name = "charger" id="charge">
                                    <br>
                                  </div>
                                  <button type="submit" class="btn btn-primary float-right" onclick="func_update()">Add/Updata Service</button>
                            </form>
                            <script type="text/javascript">
                                function func_query(){
                                    var sel2=$("#sel2").val();
                                    $.post("../backend/query_service.php",
                                    {
                                        sellist2:sel2
                                    },
                                    function(data){
                                        func_change(data);
                                    });
                                }
                                function func_change(para){
                                    var element = document.getElementById("charge");
                                    element.value = para;
                                }
                                function func_update(){
                                    // event.preventDefault()
                                    // var sel2=$("#sel2").val();
                                    // var tableRef;
                                    // if (sel2 == 'Haircut') {
                                    //     var tableRef = document.getElementById('t1').getElementsByTagName('tbody')[0];
                                    // } else if (sel2 == 'Hair Wash & Dry') {
                                    //     var tableRef = document.getElementById('t2').getElementsByTagName('tbody')[0];
                                    // } else {
                                    //     var tableRef = document.getElementById('t3').getElementsByTagName('tbody')[0];
                                    // }
                                    // var row = tableRef.insertRow(0);      
                                    // var newCell = row.insertCell(0);
                                    // var newCell2 = row.insertCell(1);
                                    
                                    // var newCell3 = row.insertCell(2);
                                    // var newCell4 = row.insertCell(3);
                                    
                                    // var newCell5 = row.insertCell(2);

                                    // var sel1=$("#sel1").val();
                                    // /*
                                    // var sel3=$("#sel3").val();
                                    // var sel4=$("#sel4").val();
                                    // */
                                    // var charge = document.getElementById("charge").value

                                    // newCell.innerHTML="ID";
                                    // newCell2.innerHTML="" + sel1;
                                    // /*
                                    // newCell3.innerHTML="" + sel3;
                                    // newCell4.innerHTML="" + sel4;
                                    // */
                                    // newCell5.innerHTML="" + charge;
                                    
                                    var element = document.getElementById("server_service");
                                    element.action = "../backend/update_service.php"
                                    element.submit();
                                    alert("success update")
                                    location.reload();
                                }
                            </script>
                            <iframe id="id_iframe" name="nm_iframe" style="display:none;"></iframe>
                             
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</body>
</html>